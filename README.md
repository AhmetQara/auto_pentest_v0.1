# Auto Penetration Tester Tool Version 0.8 

# How to Use

python **auto_pentest_v01.py** -u **target_url** (without http://)
## Example:

python **auto_pentest_v01.py** -u **example.com** 

# **Specs:**

+ Checks 80 & 443 ports with **Nmap**
+ Dir search with **Gobuster**
+ Run **Nuclei** on the host 
+ Output Hosts and Ports Status

## created by [@ahmetkara](https://github.com/ahmetQara)



*Broken Object Level Authorization (BOLA)*

Broken Object Level Authorization, nesnelerin yetkilendirme işlemlerinde oluşabilecek hataları ifade eder. Örneğin, bir web uygulamasında kullanıcıların sadece kendi bilgilerine erişebilmelerini sağlamak için yetkilendirme kontrolleri yapılır. Ancak, eğer bu kontroller hatalı yapılmışsa, kullanıcılar diğer kullanıcıların bilgilerine de erişebilirler. Bu durumda, "Broken Object Level Authorization" olarak adlandırılır.

*Örnek saldırı senaryoları (usecase)*

    X kullanıcısına ait bir finansal bilgisinin, Y kullanıcısı tarafından görülebilmesi yada tam tersi

    Y kullanıcısına ait olan id2 numaralı finansal numarasının, X kullanıcısı tarafından görüntülenebilmesi
    target/accounts/id1/financial_info -> X kullanıcısına ait olan finansal numarası
    target/accounts/id2/financial_info -> Y kullanıcısına ait olan finansal numarası

Yukarıdaki istekler değerlendirildiğinde GET metodu ile alınan id ile başlayan parametre, veritabanında sorgulanarak isteği gerçekleştiren kişi doğrulanmadan ekrana sonuçlar yazdırılır.


*Önleme Yöntemleri*

    Ziyaretçi veya kullanıcı tarafından, yukarıda verdiğimiz saldırı isteklerine benzer bir istek alındığında, burada yer alan ID nesnesinin hangi kullanıcıya aitse, o kullanıcı tarafından aktif bir oturumun olup, olmadığı sorgulanmalıdır. Eğer ki oturum, ilgili nesnenin sahibine ait değilse giriş sayfasına yönlendirilmelidir.


****************************************************************************************************************

*Lack of Resources and Rate Limiting*

Güvenlik test uzmanlarının da sıklıkla karşılaştığı problemlerden biri de rate limiting konusudur. En temelde bir hizmetin istek sınırlaması olmaksızın talepleri karşılamaya çalışmasıdır. Bu bir SMS servisi olabileceği gibi, giriş ekranı parola sıfırlama modülü de olabilir. Kaynakların tüketilmesine sebep olan bu olayda kritik önem taşıyan e-posta, SMS gibi hizmetler kuyruk mantığıyla çalışması sebebiyle aksamalara sebep verebilir.

*Örnek saldırı senaryoları*

    Dosya yükleme alanlarının, verinin kontrol edilmemesi sonucu büyük boyutlu verinin disk üzerinde yer kaplaması
    Tek kullanımlık parolaların gönderildiği servislere yönelik birden fazla istek sonucu ilgili servisin hizmet verememesi
    Tek kullanımlık parolanın istek limiti olmadığından dolayı tahmin edilebilmesi
    Parola kurtarma sonucu

*Önleme Yöntemleri*

    Uygun şekilde hız sınırlaması tanımlanması, örneğin saniyede 100 ziyaretçi vb. gibi
    Dosya yükleme limitlerinin tanımlanması.
    Giriş, parola sıfırlama gibi ekranlarda belirlenen sayı üzerinde aynı kaynaktan istek gelmesi durumunda captcha çıkartılması

****************************************************************************************************************

*Mass Assignment*

API, istemciden aldığı verileri ilgili modelin alanlarına kontrolsüz olarak yazması olayı sonrasında ortaya çıkan güvenlik problemidir. Örneğin profil bilgilerinin güncellendiği bir sayfa yapısı düşünelim. Bu sayfa yapısında “ad, soyad” bilgilerinin güncellenememesini, yalnızca e-posta alanının güncellenebilir olduğunu varsayalım.

*Örnek saldırı senaryoları*

    Eğer ki arkaplanda user modeli için aşağıdaki yapı tasarlandıysa saldırganlar sizin güncellenmesini istemediğiniz alanlar için de işlem yapabilir durumdadır.
    Rails için örnek kod yapısı aşağıdaki verilmiştir. Bu satırda kullanıcıdan alınan parametreler doğrudan User modelinin alanlarına yazılmaktadır. Herhangi bir kontrol işlemi yapılmamaktadır.
        @user = User.new(params[:user])

*Önleme Yöntemleri*

    Kullanıcıdan alınan verileri doğrudan nesnenin alanlarına bağlamayın.
    Kullanıcıdan gelen parametrelerin aksine hangi parametrelerin gelebileceğini bir liste olarak belirleyin.
    API’ler tarafından alınabilecek fakat güncellenmesini istemediğiniz tüm alanlar için readonly özelliğini kullanın.

****************************************************************************************************************
